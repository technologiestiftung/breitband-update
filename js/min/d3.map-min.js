function d3_map(e){function t(e){a=e,t.init();var r=d3.select("#map-legend"),o=d3.scale.linear().domain(g).range([199,150,100,50,0]),l=d3.svg.axis().scale(o).orient("top").tickValues(g).tickFormat(function(e,t){return e+"%"});r.append("g").attr("class","x axis").attr("transform","translate(20,33)").call(l),r.append("defs").append("linearGradient").attr("id","gradient").attr("x1","100%").attr("y1","0%").attr("x2","0%").attr("y2","0%").attr("spreadMethod","pad").selectAll("stop").data(u).enter().append("stop").attr("offset",function(e,t){return 100/u.length*t+"%"}).attr("stop-color",function(e){return"rgb("+e.r+","+e.g+","+e.b+")"}).attr("stop-opacity",1),r.append("rect").attr("x",20).attr("y",30).attr("width",200).attr("height",20).style("stroke","#000").style("stroke-width",.5).style("fill","url(#gradient)")}var a,r=e,o=500,l=500,n="b-100-alle",p="100",d={speed:100,type:"b",technology:"alle"},i,s=d3.geo.mercator().scale(5e4).precision(.1).center([13.403,52.51]).translate([o/2,l/2]),c=d3.geo.path().projection(s),u=[{r:189,g:0,b:38,a:.8},{r:240,g:59,b:32,a:.8},{r:253,g:141,b:60,a:.8},{r:254,g:204,b:92,a:.8},{r:255,g:255,b:178,a:.8}],g=[100,95,75,50,10],h=d3.scale.linear().domain(g).range(u);return t.init=function(){a.append("svg").attr("viewBox","0 0 "+o+" "+l).attr("preserveAspectRatio","xMidYMid meet").selectAll("path").data(r).enter().append("path").attr("d",function(e){return c(e)}).on("mouseover",function(){var e=d3.select(this),t=e.data()[0],a=e.node().getBoundingClientRect();"de"==lang?tooltip.content("<strong>"+t.properties.bez+", "+t.properties.bzr+", "+t.properties.plr+"</strong><br />Netz mit einer Geschwindigkeit von<br /> bis zu "+p+" Mbit/s ist zu "+t.properties[n]+"% verf√ºgbar."):tooltip.content("<strong>"+t.properties.bez+", "+t.properties.bzr+", "+t.properties.plr+"</strong><br />Connection speeds <br /> of up to "+p+" Mbit/s are "+t.properties[n]+"% available."),tooltip.position([a.left+window.pageXOffset+a.width/2,a.top+window.pageYOffset+a.height/2]),tooltip.show()}).on("mouseout",function(){tooltip.hide()}),t.updateColor(),t.resize(),d3.select("#map-type").on("change",function(){var e=d3.select(this).property("value");d.type=e,"b"==e?(d.speed=100,d.technology="alle",d3.selectAll("#karte .p-disable").attr("disabled",null),d3.selectAll("#karte .b-disable").attr("disabled","disabled"),d3.select("#map-technology").property("value","alle"),d3.select("#map-speed").property("value","100")):(d.speed=100,d.technology="alle",d3.select("#map-technology").property("value","alle"),d3.select("#map-speed").property("value","100"),d3.selectAll("#karte .p-disable").attr("disabled","disabled"),d3.selectAll("#karte .b-disable").attr("disabled",null)),t.updateSpeed()}),d3.select("#map-technology").on("change",function(){var e=d3.select(this).property("value");d.technology=e,t.updateSpeed()}),d3.select("#map-speed").on("change",function(){var e=d3.select(this).property("value");d.speed=e,t.updateSpeed()})},t.updateSpeed=function(){n="b"==d.type?d.type+"-"+d.speed+"-"+d.technology:d.type+"-"+("alle"==d.technology?"all":d.technology)+"-"+d.speed+"_mbit",p=d.speed,t.updateColor()},t.updateColor=function(){a.selectAll("path").data(r).style("fill",function(e){var t=h(e.properties[n]);return"rgb("+Math.round(t.r)+","+Math.round(t.g)+","+Math.round(t.b)+")"})},t.switchSpeed=function(e){i=e,t.updateColor()},t.resize=function(){var e=d3.select("#map"),t=e.node().getBoundingClientRect();o=t.width,l=o,o>500&&(l=500),a.style("height",l+"px")},t}